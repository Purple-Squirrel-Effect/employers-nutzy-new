---
import BrowserMockup from "./BrowserMockup.astro";

export interface Card {
  id: string;
  image?: string;
  wireframe?: string;
  alt: string;
  title?: string;
  subtitle?: string;
  websiteType?: string;
  backgroundColor?: string;
}

export interface Props {
  cards: Card[];
  className?: string;
}

const {
  cards,
  className = "",
} = Astro.props;

// Predefined scattered positions using Tailwind classes
const scatteredPositions = [
  "top-16 left-12 rotate-12 w-72 h-48 z-10",
  "top-32 right-16 -rotate-6 w-64 h-44 z-20",
  "top-48 left-1/3 rotate-3 w-80 h-52 z-30",
  "top-20 right-1/4 -rotate-12 w-68 h-46 z-40",
  "top-64 left-20 rotate-6 w-76 h-50 z-50",
  "top-40 right-8 -rotate-3 w-72 h-48 z-60",
  "top-12 left-1/2 rotate-6 w-70 h-46 z-70",
  "top-56 right-1/3 -rotate-9 w-74 h-50 z-80",
  "top-28 left-8 rotate-15 w-66 h-44 z-90",
  "top-72 right-12 -rotate-4 w-78 h-52 z-100",
];
---

<!-- Scattered Cards Container -->
<div class={`relative w-full h-full ${className}`}>
  {
    cards.map((card, index) => {
      const positionClasses = scatteredPositions[index % scatteredPositions.length];

      return (
        <div
          class={`gallery-card absolute rounded-2xl shadow-2xl overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-3xl hover:z-50 pointer-events-auto cursor-pointer focus:outline-2 focus:outline-white focus:outline-offset-4 ${positionClasses}`}
          data-card-id={card.id}
          data-index={index}
          data-card
          tabindex="0"
          role="button"
          aria-label={`Brand card ${index + 1}: ${card.title || card.alt}`}
        >
          <!-- MacBook Mockup Container -->
          <div class="macbook-mockup relative w-full h-full">
            <!-- MacBook Device Frame -->
            <div class="relative z-10 w-full h-full">
              <img
                src="/img/macbook-mockup.svg"
                alt="Browser tab"
                class="w-full h-full object-contain"
                loading="lazy"
              />

              <!-- Screen Content Overlay -->
              <div class="absolute inset-0">
                <!-- Screen area positioned to fill the entire tab -->
                <div class="screen-content w-full h-full rounded-lg overflow-hidden">
                  {card.wireframe ? (
                    <BrowserMockup
                      wireframeSrc={card.wireframe}
                      websiteTitle={card.title || "Website"}
                      className="w-full h-full"
                    />
                  ) : card.image ? (
                    <img
                      src={card.image}
                      alt={card.alt}
                      class="w-full h-full object-cover"
                      loading="lazy"
                    />
                  ) : (
                    <div class="w-full h-full bg-primary-200 flex items-center justify-center">
                      <span class="text-primary-900 text-sm">No content</span>
                    </div>
                  )}
                </div>
              </div>
            </div>
          </div>

          <!-- Card Title Overlay (positioned outside MacBook) -->
          {(card.title || card.subtitle) && (
            <div class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 bg-white rounded-lg shadow-lg px-3 py-2 text-center min-w-max">
              {card.title && (
                <h3 class="text-sm font-bold text-gray-800 mb-0.5">{card.title}</h3>
              )}
              {card.subtitle && (
                <p class="text-xs text-gray-600">{card.subtitle}</p>
              )}
            </div>
          )}
        </div>
      );
    })
  }
</div>
