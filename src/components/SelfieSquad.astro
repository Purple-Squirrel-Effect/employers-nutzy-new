---
import SectionTitle from "./SectionTitle.astro";
---

<div
  class="flex flex-col justify-end lg:min-h-screen w-full overflow-hidden text-center bg-white relative"
>
  <SectionTitle>
    <span class="text-black text-shadow shadow-white"
      >Dit gebeurt er op onze socials</span
    >
  </SectionTitle>

  <div class="relative">
    <iframe
      id="selfie-iframe"
      seamless="seamless"
      scrolling="no"
      class="w-full h-[150svh] mx-auto overflow-hidden rounded-lg shadow-primary-500"
      src="https://www.selfie-squad.com/nutzy"
    >
    </iframe>
    <button
      id="fullscreen-btn"
      class="absolute top-8 right-8 bg-primary-500 bg-opacity-50 text-white p-3 rounded-lg hover:bg-opacity-70 transition-all duration-200"
      aria-label="Enter fullscreen"
    >
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path
          d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"
        ></path>
      </svg>
    </button>
  </div>
  <svg
    class="animate-wave -my-[6%] absolute bottom-0"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 1440 320"
  >
    <rect class=`fill-transparent` width="1440" height="320" x="0" y="0"></rect>
    <path
      class=`fill-primary-500`
      fill-opacity="1"
      d="M0,64L34.3,69.3C68.6,75,137,85,206,80C274.3,75,343,53,411,58.7C480,64,549,96,617,122.7C685.7,149,754,171,823,186.7C891.4,203,960,213,1029,202.7C1097.1,192,1166,160,1234,128C1302.9,96,1371,64,1406,48L1440,32L1440,320L1405.7,320C1371.4,320,1303,320,1234,320C1165.7,320,1097,320,1029,320C960,320,891,320,823,320C754.3,320,686,320,617,320C548.6,320,480,320,411,320C342.9,320,274,320,206,320C137.1,320,69,320,34,320L0,320Z"
    >
    </path>
  </svg>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const iframe = document.getElementById(
      "selfie-iframe"
    ) as HTMLIFrameElement;
    const fullscreenBtn = document.getElementById(
      "fullscreen-btn"
    ) as HTMLButtonElement;

    if (!iframe || !fullscreenBtn) return;

    function enterFullscreen() {
      // Create a fullscreen container
      const fullscreenContainer = document.createElement("div");
      fullscreenContainer.id = "fullscreen-container";
      fullscreenContainer.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: black;
        z-index: 9999;
        overflow: hidden;
      `;

      // Clone the iframe for fullscreen
      const fullscreenIframe = iframe.cloneNode(true) as HTMLIFrameElement;
      // Remove any deprecated attributes
      fullscreenIframe.removeAttribute("scrolling");
      fullscreenIframe.style.cssText = `
        width: 100%;
        height: 100%;
        border: none;
        overflow: hidden;
      `;

      // Create exit button
      const exitBtn = document.createElement("button");
      exitBtn.innerHTML = `
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      `;
      exitBtn.style.cssText = `
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        padding: 12px;
        border-radius: 8px;
        cursor: pointer;
        z-index: 10000;
        transition: background-color 0.2s;
      `;
      exitBtn.addEventListener("mouseenter", () => {
        exitBtn.style.backgroundColor = "rgba(0, 0, 0, 0.9)";
      });
      exitBtn.addEventListener("mouseleave", () => {
        exitBtn.style.backgroundColor = "rgba(0, 0, 0, 0.7)";
      });

      // Add elements to container
      fullscreenContainer.appendChild(fullscreenIframe);
      fullscreenContainer.appendChild(exitBtn);
      document.body.appendChild(fullscreenContainer);

      // Hide body overflow
      document.body.style.overflow = "hidden";

      // Exit fullscreen function
      function exitFullscreen() {
        document.body.removeChild(fullscreenContainer);
        document.body.style.overflow = "";
      }

      // Event listeners for exit
      exitBtn.addEventListener("click", exitFullscreen);
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
          exitFullscreen();
        }
      });
    }

    fullscreenBtn.addEventListener("click", enterFullscreen);
  });
</script>
